<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300, "strokeWidth": 0}, "axis": {"grid": false}, "axisX": {"labelAngle": 270, "labelFontSize": 12}, "axisY": {"labelFontSize": 12, "titleFontSize": 14, "titlePadding": 20}}, "layer": [{"data": {"name": "data-d7bf1c55b0988c1d4cbe5e15b4b7b3ac"}, "mark": {"type": "point", "filled": true, "opacity": 1, "size": 200}, "encoding": {"color": {"field": "legible_name", "legend": null, "scale": {"domain": ["Influenza C/Mississippi", "NL63", "Dengue 2-AA", "Dengue 1-I", "Dengue 1-III", "Parainfluenza-1", "Enterovirus D68", "OC43-A", "Dengue 4-I", "Norovirus GII.4", "Dengue 1-IV", "Dengue 3-III", "Dengue 2-C", "RSV-B", "Dengue 1-V", "Dengue 2-AI", "Measles", "229E", "Dengue 4-II", "Parainfluenza-3", "RSV-A", "Influenza B/Vic", "Rotavirus A/G1P[8]", "Dengue 3-II", "Mumps", "Influenza A/H3N2", "Influenza B/Yam", "Influenza C/Yamagata"], "range": ["#c40062", "#BBE4D1", "#2cccf2", "#0db0d6", "#0db0d6", "#ff9000", "#9779bd", "#208288", "#adebfa", "#5700bc", "#0db0d6", "#76def7", "#2cccf2", "#6C7593", "#0db0d6", "#2cccf2", "#F5AD52", "#76C7BE", "#adebfa", "#ffb24e", "#0B194C", "#E06E85", "#1a3da6", "#76def7", "#eb520d", "#9F2A44", "#ED9AB0", "#eb0076"]}, "type": "nominal"}, "href": {"field": "nextstrain_tree_url", "type": "nominal"}, "tooltip": [{"field": "legible_name", "title": "Virus", "type": "nominal"}, {"field": "legible_rate_percodon", "title": "Rate", "type": "nominal"}], "x": {"axis": {"labelExpr": "datum.label == 1 ? 'Measles H' : datum.label == 2 ? 'H3N2 HA1' : datum.label == 4 ? 'R' : datum.label == 6 ? 'C' : datum.label == 8 ? 'M' : datum.label == 10 ? 'P' : datum.label == 12 ? 'A' : datum.label == 14 ? 'I' : datum.label == 16 ? 'T' : datum.label == 18 ? 'N' : datum.label == 20 ? 'G' : 'E'", "tickCount": 12, "values": [1, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22]}, "field": "xtick_pos", "title": "", "type": "quantitative"}, "y": {"axis": {"format": ".1f", "title": ["Adaptive Mutations", "per Year"]}, "field": "adaptive_muts_per_year", "type": "quantitative"}}, "height": 250, "width": 600}, {"data": {"name": "data-d7bf1c55b0988c1d4cbe5e15b4b7b3ac"}, "mark": "errorbar", "encoding": {"color": {"field": "legible_name", "legend": null, "scale": {"domain": ["Influenza C/Mississippi", "NL63", "Dengue 2-AA", "Dengue 1-I", "Dengue 1-III", "Parainfluenza-1", "Enterovirus D68", "OC43-A", "Dengue 4-I", "Norovirus GII.4", "Dengue 1-IV", "Dengue 3-III", "Dengue 2-C", "RSV-B", "Dengue 1-V", "Dengue 2-AI", "Measles", "229E", "Dengue 4-II", "Parainfluenza-3", "RSV-A", "Influenza B/Vic", "Rotavirus A/G1P[8]", "Dengue 3-II", "Mumps", "Influenza A/H3N2", "Influenza B/Yam", "Influenza C/Yamagata"], "range": ["#c40062", "#BBE4D1", "#2cccf2", "#0db0d6", "#0db0d6", "#ff9000", "#9779bd", "#208288", "#adebfa", "#5700bc", "#0db0d6", "#76def7", "#2cccf2", "#6C7593", "#0db0d6", "#2cccf2", "#F5AD52", "#76C7BE", "#adebfa", "#ffb24e", "#0B194C", "#E06E85", "#1a3da6", "#76def7", "#eb520d", "#9F2A44", "#ED9AB0", "#eb0076"]}, "type": "nominal"}, "tooltip": {"value": null}, "x": {"field": "xtick_pos", "title": "", "type": "quantitative"}, "y": {"field": "lower_95ci_mutspergene", "title": "", "type": "quantitative"}, "y2": {"field": "upper_95ci_mutspergene"}}, "height": 250, "width": 600}, {"data": {"name": "data-994311638f0b9d22a99d01543c25f213"}, "mark": {"type": "rule", "strokeDash": [3, 5]}, "encoding": {"x": {"field": "x", "type": "quantitative"}}}], "data": {"name": "data-d7bf1c55b0988c1d4cbe5e15b4b7b3ac"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-d7bf1c55b0988c1d4cbe5e15b4b7b3ac": [{"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "R", "adaptive_subs_per_codon_per_year": 0.1177280039042367, "lower_95ci": 0.0006008732735441, "upper_95ci": 0.3155784052557804, "ci": "[0.0006008732735441946, 0.3155784052557804]", "len_in_codons": 1089, "adaptive_muts_per_year": 0.1282057962517138, "lower_95ci_mutspergene": 0.0006543509948896, "upper_95ci_mutspergene": 0.3436648833235449, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.12\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.13 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/r/", "xtick_pos": 4}, {"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "C", "adaptive_subs_per_codon_per_year": 0.1623553537956489, "lower_95ci": 7.83460938601011e-06, "upper_95ci": 0.4049005402354635, "ci": "[7.83460938601011e-06, 0.40490054023546357]", "len_in_codons": 883, "adaptive_muts_per_year": 0.143359777401558, "lower_95ci_mutspergene": 6.917960087846927e-06, "upper_95ci_mutspergene": 0.3575271770279143, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.16\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.14 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/c/", "xtick_pos": 6}, {"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "M", "adaptive_subs_per_codon_per_year": 0.1940410314725676, "lower_95ci": 0.0, "upper_95ci": 0.5111075287498823, "ci": "[0.0, 0.5111075287498823]", "len_in_codons": 836, "adaptive_muts_per_year": 0.1622183023110665, "lower_95ci_mutspergene": 0.0, "upper_95ci_mutspergene": 0.4272858940349016, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.19\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.16 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/m/", "xtick_pos": 8}, {"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "P", "adaptive_subs_per_codon_per_year": 0.057332142098664, "lower_95ci": 0.0, "upper_95ci": 0.202510927636162, "ci": "[0.0, 0.202510927636162]", "len_in_codons": 777, "adaptive_muts_per_year": 0.0445470744106619, "lower_95ci_mutspergene": 0.0, "upper_95ci_mutspergene": 0.1573509907732978, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.06\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.04 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/p/", "xtick_pos": 10}, {"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "A", "adaptive_subs_per_codon_per_year": 0.2247681381568599, "lower_95ci": 0.0045993319297786, "upper_95ci": 0.5526742912961269, "ci": "[0.004599331929778617, 0.5526742912961269]", "len_in_codons": 497, "adaptive_muts_per_year": 0.1117097646639593, "lower_95ci_mutspergene": 0.0022858679690999, "upper_95ci_mutspergene": 0.2746791227741751, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.22\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.11 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/a/", "xtick_pos": 12}, {"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "I", "adaptive_subs_per_codon_per_year": 0.0, "lower_95ci": 0.0, "upper_95ci": 0.0, "ci": "[0.0, 0.0]", "len_in_codons": 398, "adaptive_muts_per_year": 0.0, "lower_95ci_mutspergene": 0.0, "upper_95ci_mutspergene": 0.0, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.0\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.0 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/i/", "xtick_pos": 14}, {"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "T", "adaptive_subs_per_codon_per_year": 0.0240964764964914, "lower_95ci": 0.0, "upper_95ci": 0.0871182106295678, "ci": "[0.0, 0.08711821062956784]", "len_in_codons": 316, "adaptive_muts_per_year": 0.0076144865728912, "lower_95ci_mutspergene": 0.0, "upper_95ci_mutspergene": 0.0275293545589434, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.02\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.01 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/t/", "xtick_pos": 16}, {"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "N", "adaptive_subs_per_codon_per_year": 0.8398001642859929, "lower_95ci": 0.0141434772767509, "upper_95ci": 1.8381629661679708, "ci": "[0.014143477276750995, 1.8381629661679708]", "len_in_codons": 318, "adaptive_muts_per_year": 0.2670564522429457, "lower_95ci_mutspergene": 0.0044976257740068, "upper_95ci_mutspergene": 0.5845358232414147, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.84\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.27 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/n/", "xtick_pos": 18}, {"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "G", "adaptive_subs_per_codon_per_year": 0.0730856457209623, "lower_95ci": -0.0758367409129037, "upper_95ci": 0.3249661292351802, "ci": "[-0.07583674091290372, 0.3249661292351802]", "len_in_codons": 327, "adaptive_muts_per_year": 0.0238990061507546, "lower_95ci_mutspergene": -0.0247986142785195, "upper_95ci_mutspergene": 0.1062639242599039, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.07\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.02 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/g/", "xtick_pos": 20}, {"virus": "rotavirusAg1p8", "subtype": "", "virus_and_subtype": "rotavirusAg1p8", "gene": "E", "adaptive_subs_per_codon_per_year": 0.3185813422069479, "lower_95ci": 0.0, "upper_95ci": 1.4514262230956017, "ci": "[0.0, 1.4514262230956017]", "len_in_codons": 176, "adaptive_muts_per_year": 0.0560703162284228, "lower_95ci_mutspergene": 0.0, "upper_95ci_mutspergene": 0.2554510152648259, "legible_name": "Rotavirus A/G1P[8]", "virus_family": "reovirus", "color": "#1a3da6", "legible_rate_percodon": "0.32\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.06 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/rotavirusA/e/", "xtick_pos": 22}, {"virus": "measles", "subtype": "", "virus_and_subtype": "measles", "gene": "Measles H", "adaptive_subs_per_codon_per_year": 0.1488760781105891, "lower_95ci": 0.0, "upper_95ci": 0.464536965766201, "ci": "[0.0, 0.46453696576620107]", "len_in_codons": 618, "adaptive_muts_per_year": 0.0920054162723441, "lower_95ci_mutspergene": 0.0, "upper_95ci_mutspergene": 0.2870838448435123, "legible_name": "Measles", "virus_family": "paramyxovirus", "color": "#F5AD52", "legible_rate_percodon": "0.15\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.09 muts per year", "nextstrain_tree_url": "https://nextstrain.org/measles", "xtick_pos": 1}, {"virus": "h3n2", "subtype": "", "virus_and_subtype": "h3n2", "gene": "H3N2 HA1", "adaptive_subs_per_codon_per_year": 3.968017826307325, "lower_95ci": 2.958853820205344, "upper_95ci": 4.99468539503025, "ci": "[2.9588538202053436, 4.99468539503025]", "len_in_codons": 329, "adaptive_muts_per_year": 1.3054778648551095, "lower_95ci_mutspergene": 0.973462906847558, "upper_95ci_mutspergene": 1.6432514949649522, "legible_name": "Influenza A/H3N2", "virus_family": "orthomyxovirus", "color": "#9F2A44", "legible_rate_percodon": "3.97\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "1.31 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/flu/seasonal/h3n2/ha/60y", "xtick_pos": 2}], "data-994311638f0b9d22a99d01543c25f213": [{"x": 3}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>
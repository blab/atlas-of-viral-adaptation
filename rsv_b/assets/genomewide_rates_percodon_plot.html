<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300, "strokeWidth": 0}, "axis": {"grid": false}, "axisX": {"labelAngle": 270, "labelFontSize": 12}, "axisY": {"labelFontSize": 12, "titleFontSize": 14, "titlePadding": 20}}, "layer": [{"data": {"name": "data-a30860b7a608523d3bda7eaa96ab04f4"}, "mark": {"type": "point", "filled": true, "opacity": 1, "size": 200}, "encoding": {"color": {"field": "legible_name", "legend": null, "scale": {"domain": ["229E", "Measles", "NL63", "RSV-A", "RSV-B", "Influenza A/H3N2", "OC43-A", "Mumps", "Norovirus GII.4"], "range": ["#76C7BE", "#F5AD52", "#BBE4D1", "#0B194C", "#6C7593", "#9F2A44", "#208288", "#f58452", "#d0b9d2"]}, "type": "nominal"}, "tooltip": [{"field": "legible_name", "title": "Virus", "type": "nominal"}, {"field": "legible_rate_percodon", "title": "Rate", "type": "nominal"}], "x": {"axis": {"labelExpr": "datum.label == 1 ? 'Measles H' : datum.label == 2 ? 'H3N2 HA1' : datum.label == 4 ? 'NS1' : datum.label == 6 ? 'NS2' : datum.label == 8 ? 'N' : datum.label == 10 ? 'P' : datum.label == 12 ? 'M' : datum.label == 14 ? 'SH' : datum.label == 16 ? 'G' : datum.label == 18 ? 'F' : 'L'", "tickCount": 11, "values": [1, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20]}, "field": "xtick_pos", "title": "", "type": "quantitative"}, "y": {"axis": {"format": ".1f", "title": ["Adaptive Mutations", "per Codon per Year (\u00d7 10\u207b\u00b3)"]}, "field": "adaptive_subs_per_codon_per_year", "type": "quantitative"}}, "height": 250, "width": 600}, {"data": {"name": "data-a30860b7a608523d3bda7eaa96ab04f4"}, "mark": "errorbar", "encoding": {"color": {"field": "legible_name", "legend": null, "scale": {"domain": ["229E", "Measles", "NL63", "RSV-A", "RSV-B", "Influenza A/H3N2", "OC43-A", "Mumps", "Norovirus GII.4"], "range": ["#76C7BE", "#F5AD52", "#BBE4D1", "#0B194C", "#6C7593", "#9F2A44", "#208288", "#f58452", "#d0b9d2"]}, "type": "nominal"}, "tooltip": {"value": null}, "x": {"field": "xtick_pos", "title": "", "type": "quantitative"}, "y": {"field": "lower_95ci", "title": "", "type": "quantitative"}, "y2": {"field": "upper_95ci"}}, "height": 250, "width": 600}, {"data": {"name": "data-994311638f0b9d22a99d01543c25f213"}, "mark": {"type": "rule", "strokeDash": [3, 5]}, "encoding": {"x": {"field": "x", "type": "quantitative"}}}], "data": {"name": "data-a30860b7a608523d3bda7eaa96ab04f4"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-a30860b7a608523d3bda7eaa96ab04f4": [{"virus": "rsv", "subtype": "B", "virus_and_subtype": "rsv_B", "gene": "NS1", "adaptive_subs_per_codon_per_year": 0.6257729176360909, "lower_95ci": -0.0655504902796267, "upper_95ci": 1.2784067930890646, "ci": "[-0.06555049027962674, 1.2784067930890646]", "len_in_codons": 140, "adaptive_muts_per_year": 0.0876082084690527, "lower_95ci_mutspergene": -0.0091770686391477, "upper_95ci_mutspergene": 0.178976951032469, "legible_name": "RSV-B", "virus_family": "pneumovirus", "color": "#6C7593", "legible_rate_percodon": "0.63\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.09 muts per year", "xtick_pos": 4}, {"virus": "rsv", "subtype": "B", "virus_and_subtype": "rsv_B", "gene": "NS2", "adaptive_subs_per_codon_per_year": 0.0686452292333881, "lower_95ci": -0.0216177616203583, "upper_95ci": 0.224130637063966, "ci": "[-0.021617761620358347, 0.22413063706396608]", "len_in_codons": 125, "adaptive_muts_per_year": 0.0085806536541735, "lower_95ci_mutspergene": -0.0027022202025447, "upper_95ci_mutspergene": 0.0280163296329957, "legible_name": "RSV-B", "virus_family": "pneumovirus", "color": "#6C7593", "legible_rate_percodon": "0.07\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.01 muts per year", "xtick_pos": 6}, {"virus": "rsv", "subtype": "B", "virus_and_subtype": "rsv_B", "gene": "N", "adaptive_subs_per_codon_per_year": 0.0927890906035474, "lower_95ci": -0.0336620571798354, "upper_95ci": 0.3248590372792078, "ci": "[-0.033662057179835496, 0.3248590372792078]", "len_in_codons": 392, "adaptive_muts_per_year": 0.0363733235165905, "lower_95ci_mutspergene": -0.0131955264144955, "upper_95ci_mutspergene": 0.1273447426134494, "legible_name": "RSV-B", "virus_family": "pneumovirus", "color": "#6C7593", "legible_rate_percodon": "0.09\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.04 muts per year", "xtick_pos": 8}, {"virus": "rsv", "subtype": "B", "virus_and_subtype": "rsv_B", "gene": "P", "adaptive_subs_per_codon_per_year": 0.130173952354262, "lower_95ci": -0.0543434590367541, "upper_95ci": 0.3797051615044806, "ci": "[-0.05434345903675412, 0.3797051615044806]", "len_in_codons": 242, "adaptive_muts_per_year": 0.0315020964697314, "lower_95ci_mutspergene": -0.0131511170868944, "upper_95ci_mutspergene": 0.0918886490840843, "legible_name": "RSV-B", "virus_family": "pneumovirus", "color": "#6C7593", "legible_rate_percodon": "0.13\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.03 muts per year", "xtick_pos": 10}, {"virus": "rsv", "subtype": "B", "virus_and_subtype": "rsv_B", "gene": "M", "adaptive_subs_per_codon_per_year": 0.1287873347014022, "lower_95ci": 0.0, "upper_95ci": 0.3863620041042065, "ci": "[0.0, 0.3863620041042065]", "len_in_codons": 257, "adaptive_muts_per_year": 0.0330983450182603, "lower_95ci_mutspergene": 0.0, "upper_95ci_mutspergene": 0.099295035054781, "legible_name": "RSV-B", "virus_family": "pneumovirus", "color": "#6C7593", "legible_rate_percodon": "0.13\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.03 muts per year", "xtick_pos": 12}, {"virus": "rsv", "subtype": "B", "virus_and_subtype": "rsv_B", "gene": "SH", "adaptive_subs_per_codon_per_year": 0.3829232723849545, "lower_95ci": -0.2331063673504154, "upper_95ci": 1.772727374385654, "ci": "[-0.23310636735041548, 1.772727374385654]", "len_in_codons": 66, "adaptive_muts_per_year": 0.0252729359774069, "lower_95ci_mutspergene": -0.0153850202451274, "upper_95ci_mutspergene": 0.1170000067094531, "legible_name": "RSV-B", "virus_family": "pneumovirus", "color": "#6C7593", "legible_rate_percodon": "0.38\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.03 muts per year", "xtick_pos": 14}, {"virus": "rsv", "subtype": "B", "virus_and_subtype": "rsv_B", "gene": "G", "adaptive_subs_per_codon_per_year": 2.1439093828606683, "lower_95ci": 1.2801227304766734, "upper_95ci": 3.3767220257559565, "ci": "[1.2801227304766734, 3.3767220257559565]", "len_in_codons": 300, "adaptive_muts_per_year": 0.6431728148582004, "lower_95ci_mutspergene": 0.384036819143002, "upper_95ci_mutspergene": 1.0130166077267868, "legible_name": "RSV-B", "virus_family": "pneumovirus", "color": "#6C7593", "legible_rate_percodon": "2.14\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.64 muts per year", "xtick_pos": 16}, {"virus": "rsv", "subtype": "B", "virus_and_subtype": "rsv_B", "gene": "F", "adaptive_subs_per_codon_per_year": 0.1122302522297368, "lower_95ci": 0.0074100434525581, "upper_95ci": 0.3037582964712365, "ci": "[0.007410043452558189, 0.30375829647123653]", "len_in_codons": 575, "adaptive_muts_per_year": 0.0645323950320986, "lower_95ci_mutspergene": 0.0042607749852209, "upper_95ci_mutspergene": 0.174661020470961, "legible_name": "RSV-B", "virus_family": "pneumovirus", "color": "#6C7593", "legible_rate_percodon": "0.11\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.06 muts per year", "xtick_pos": 18}, {"virus": "rsv", "subtype": "B", "virus_and_subtype": "rsv_B", "gene": "L", "adaptive_subs_per_codon_per_year": 0.227456322682962, "lower_95ci": 0.0999231081717831, "upper_95ci": 0.325143188036216, "ci": "[0.09992310817178313, 0.32514318803621606]", "len_in_codons": 2167, "adaptive_muts_per_year": 0.4928978512539786, "lower_95ci_mutspergene": 0.216533375408254, "upper_95ci_mutspergene": 0.7045852884744802, "legible_name": "RSV-B", "virus_family": "pneumovirus", "color": "#6C7593", "legible_rate_percodon": "0.23\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.49 muts per year", "xtick_pos": 20}, {"virus": "measles", "subtype": "", "virus_and_subtype": "measles", "gene": "Measles H", "adaptive_subs_per_codon_per_year": 0.1488760781105891, "lower_95ci": 0.0, "upper_95ci": 0.464536965766201, "ci": "[0.0, 0.46453696576620107]", "len_in_codons": 618, "adaptive_muts_per_year": 0.0920054162723441, "lower_95ci_mutspergene": 0.0, "upper_95ci_mutspergene": 0.2870838448435123, "legible_name": "Measles", "virus_family": "paramyxovirus", "color": "#F5AD52", "legible_rate_percodon": "0.15\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.09 muts per year", "xtick_pos": 1}, {"virus": "h3n2", "subtype": "", "virus_and_subtype": "h3n2", "gene": "H3N2 HA1", "adaptive_subs_per_codon_per_year": 3.968017826307325, "lower_95ci": 2.958853820205344, "upper_95ci": 4.99468539503025, "ci": "[2.9588538202053436, 4.99468539503025]", "len_in_codons": 329, "adaptive_muts_per_year": 1.3054778648551095, "lower_95ci_mutspergene": 0.973462906847558, "upper_95ci_mutspergene": 1.6432514949649522, "legible_name": "Influenza A/H3N2", "virus_family": "orthomyxovirus", "color": "#9F2A44", "legible_rate_percodon": "3.97\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "1.31 muts per year", "xtick_pos": 2}], "data-994311638f0b9d22a99d01543c25f213": [{"x": 3}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>
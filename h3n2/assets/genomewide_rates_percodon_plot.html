<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300, "strokeWidth": 0}, "axis": {"grid": false}, "axisX": {"labelAngle": 270, "labelFontSize": 12}, "axisY": {"labelFontSize": 12, "titleFontSize": 14, "titlePadding": 20}}, "layer": [{"data": {"name": "data-77ccc59d11ff21cf926c21ca60b4074f"}, "mark": {"type": "point", "filled": true, "opacity": 1, "size": 200}, "encoding": {"color": {"field": "legible_name", "legend": null, "scale": {"domain": ["229E", "Measles", "NL63", "RSV-A", "RSV-B", "Influenza A/H3N2", "Enterovirus D68", "OC43-A", "Mumps", "Norovirus GII.4", "Influenza B/Yam", "Influenza B/Vic"], "range": ["#76C7BE", "#F5AD52", "#BBE4D1", "#0B194C", "#6C7593", "#9F2A44", "#a373a5", "#208288", "#f58452", "#d0b9d2", "#ED9AB0", "#E06E85"]}, "type": "nominal"}, "href": {"field": "nextstrain_tree_url", "type": "nominal"}, "tooltip": [{"field": "legible_name", "title": "Virus", "type": "nominal"}, {"field": "legible_rate_percodon", "title": "Rate", "type": "nominal"}], "x": {"axis": {"labelExpr": "datum.label == 1 ? 'Measles H' : datum.label == 3 ? 'HA1' : datum.label == 5 ? 'HA2' : datum.label == 7 ? 'NA' : datum.label == 9 ? 'NP' : datum.label == 11 ? 'PA' : datum.label == 13 ? 'PB1' : 'PB2'", "tickCount": 8, "values": [1, 3, 5, 7, 9, 11, 13, 15]}, "field": "xtick_pos", "title": "", "type": "quantitative"}, "y": {"axis": {"format": ".1f", "title": ["Adaptive Mutations", "per Codon per Year (\u00d7 10\u207b\u00b3)"]}, "field": "adaptive_subs_per_codon_per_year", "type": "quantitative"}}, "height": 250, "width": 600}, {"data": {"name": "data-77ccc59d11ff21cf926c21ca60b4074f"}, "mark": "errorbar", "encoding": {"color": {"field": "legible_name", "legend": null, "scale": {"domain": ["229E", "Measles", "NL63", "RSV-A", "RSV-B", "Influenza A/H3N2", "Enterovirus D68", "OC43-A", "Mumps", "Norovirus GII.4", "Influenza B/Yam", "Influenza B/Vic"], "range": ["#76C7BE", "#F5AD52", "#BBE4D1", "#0B194C", "#6C7593", "#9F2A44", "#a373a5", "#208288", "#f58452", "#d0b9d2", "#ED9AB0", "#E06E85"]}, "type": "nominal"}, "tooltip": {"value": null}, "x": {"field": "xtick_pos", "title": "", "type": "quantitative"}, "y": {"field": "lower_95ci", "title": "", "type": "quantitative"}, "y2": {"field": "upper_95ci"}}, "height": 250, "width": 600}, {"data": {"name": "data-d5821704ce5b97c541566c58a3f65a74"}, "mark": {"type": "rule", "strokeDash": [3, 5]}, "encoding": {"x": {"field": "x", "type": "quantitative"}}}], "data": {"name": "data-77ccc59d11ff21cf926c21ca60b4074f"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-77ccc59d11ff21cf926c21ca60b4074f": [{"virus": "h3n2", "subtype": "", "virus_and_subtype": "h3n2", "gene": "HA1", "adaptive_subs_per_codon_per_year": 3.968017826307325, "lower_95ci": 2.958853820205344, "upper_95ci": 4.99468539503025, "ci": "[2.9588538202053436, 4.99468539503025]", "len_in_codons": 329, "adaptive_muts_per_year": 1.3054778648551095, "lower_95ci_mutspergene": 0.973462906847558, "upper_95ci_mutspergene": 1.6432514949649522, "legible_name": "Influenza A/H3N2", "virus_family": "orthomyxovirus", "color": "#9F2A44", "legible_rate_percodon": "3.97\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "1.31 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/flu/seasonal/h3n2/ha/60y", "xtick_pos": 3}, {"virus": "h3n2", "subtype": "", "virus_and_subtype": "h3n2", "gene": "HA2", "adaptive_subs_per_codon_per_year": 1.0497908687777266, "lower_95ci": 0.5150513839070636, "upper_95ci": 1.728545760743127, "ci": "[0.5150513839070636, 1.728545760743127]", "len_in_codons": 221, "adaptive_muts_per_year": 0.2320037819998776, "lower_95ci_mutspergene": 0.113826355843461, "upper_95ci_mutspergene": 0.382008613124231, "legible_name": "Influenza A/H3N2", "virus_family": "orthomyxovirus", "color": "#9F2A44", "legible_rate_percodon": "1.05\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.23 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/flu/seasonal/h3n2/ha/60y", "xtick_pos": 5}, {"virus": "h3n2", "subtype": "", "virus_and_subtype": "h3n2", "gene": "NA", "adaptive_subs_per_codon_per_year": 2.288702348225223, "lower_95ci": 1.6006689708133006, "upper_95ci": 2.8676091850698437, "ci": "[1.6006689708133006, 2.8676091850698433]", "len_in_codons": 469, "adaptive_muts_per_year": 1.0734014013176298, "lower_95ci_mutspergene": 0.7507137473114379, "upper_95ci_mutspergene": 1.3449087077977564, "legible_name": "Influenza A/H3N2", "virus_family": "orthomyxovirus", "color": "#9F2A44", "legible_rate_percodon": "2.29\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "1.07 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/flu/seasonal/h3n2/na/60y", "xtick_pos": 7}, {"virus": "h3n2", "subtype": "", "virus_and_subtype": "h3n2", "gene": "NP", "adaptive_subs_per_codon_per_year": 0.5796233036036386, "lower_95ci": 0.1660515068897507, "upper_95ci": 1.0092300242781285, "ci": "[0.1660515068897507, 1.0092300242781285]", "len_in_codons": 499, "adaptive_muts_per_year": 0.2892320284982156, "lower_95ci_mutspergene": 0.0828597019379856, "upper_95ci_mutspergene": 0.5036057821147861, "legible_name": "Influenza A/H3N2", "virus_family": "orthomyxovirus", "color": "#9F2A44", "legible_rate_percodon": "0.58\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.29 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/flu/seasonal/h3n2/np/60y", "xtick_pos": 9}, {"virus": "h3n2", "subtype": "", "virus_and_subtype": "h3n2", "gene": "PA", "adaptive_subs_per_codon_per_year": 0.4503685983622781, "lower_95ci": 0.1806883163200019, "upper_95ci": 0.7353810658992417, "ci": "[0.1806883163200019, 0.7353810658992417]", "len_in_codons": 717, "adaptive_muts_per_year": 0.3229142850257534, "lower_95ci_mutspergene": 0.1295535228014413, "upper_95ci_mutspergene": 0.5272682242497563, "legible_name": "Influenza A/H3N2", "virus_family": "orthomyxovirus", "color": "#9F2A44", "legible_rate_percodon": "0.45\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.32 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/flu/seasonal/h3n2/pa/60y", "xtick_pos": 11}, {"virus": "h3n2", "subtype": "", "virus_and_subtype": "h3n2", "gene": "PB1", "adaptive_subs_per_codon_per_year": 0.3804195219421517, "lower_95ci": 0.2019456795663166, "upper_95ci": 0.587181685626881, "ci": "[0.2019456795663166, 0.587181685626881]", "len_in_codons": 758, "adaptive_muts_per_year": 0.288357997632151, "lower_95ci_mutspergene": 0.153074825111268, "upper_95ci_mutspergene": 0.4450837177051758, "legible_name": "Influenza A/H3N2", "virus_family": "orthomyxovirus", "color": "#9F2A44", "legible_rate_percodon": "0.38\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.29 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/flu/seasonal/h3n2/pb1/60y", "xtick_pos": 13}, {"virus": "h3n2", "subtype": "", "virus_and_subtype": "h3n2", "gene": "PB2", "adaptive_subs_per_codon_per_year": 0.3674116195462716, "lower_95ci": 0.139304235275068, "upper_95ci": 0.5769674595938113, "ci": "[0.13930423527506805, 0.5769674595938113]", "len_in_codons": 760, "adaptive_muts_per_year": 0.2792328308551664, "lower_95ci_mutspergene": 0.1058712188090517, "upper_95ci_mutspergene": 0.4384952692912966, "legible_name": "Influenza A/H3N2", "virus_family": "orthomyxovirus", "color": "#9F2A44", "legible_rate_percodon": "0.37\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.28 muts per year", "nextstrain_tree_url": "https://nextstrain.org/groups/blab/flu/seasonal/h3n2/pb2/60y", "xtick_pos": 15}, {"virus": "measles", "subtype": "", "virus_and_subtype": "measles", "gene": "Measles H", "adaptive_subs_per_codon_per_year": 0.1488760781105891, "lower_95ci": 0.0, "upper_95ci": 0.464536965766201, "ci": "[0.0, 0.46453696576620107]", "len_in_codons": 618, "adaptive_muts_per_year": 0.0920054162723441, "lower_95ci_mutspergene": 0.0, "upper_95ci_mutspergene": 0.2870838448435123, "legible_name": "Measles", "virus_family": "paramyxovirus", "color": "#F5AD52", "legible_rate_percodon": "0.15\u00d710\u207b\u00b3 muts per codon per year", "legible_rate_pergene": "0.09 muts per year", "nextstrain_tree_url": "https://nextstrain.org/measles", "xtick_pos": 1}], "data-d5821704ce5b97c541566c58a3f65a74": [{"x": 2}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>